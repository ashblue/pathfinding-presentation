<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>A* Pathfinding for JavaScript</title>

		<meta name="description" content="An overview of how A* pathfinding works and how to implement it into any JavaScript project">
		<meta name="author" content="Ash Blue">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/solarized.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', include the PDF print sheet -->
		<script>
			if( window.location.search.match( /print-pdf/gi ) ) {
				var link = document.createElement( 'link' );
				link.rel = 'stylesheet';
				link.type = 'text/css';
				link.href = 'css/print/pdf.css';
				document.getElementsByTagName( 'head' )[0].appendChild( link );
			}
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>A* Pathfinding</h1>
					<h3>For JavaScript and Beyond</h3>
					<p>
						<small>
                            By <a href="http://blueashes.com">Ash Blue</a> /
                            <a href="http://clevercg.com">Clever Crow Games</a> /
                            <a href="http://www.manning.com/crowther2/">HTML5 in Action</a> /
                            <a href="http://twitter.com/ashbluewd">@ashbluewd</a>
                        </small>
					</p>
				</section>

                <section>
                    <section>
                        <h2>What is AI pathfinding?</h2>
                        <p>Process of discovering a path through obstacles <br/> between two points</p>

                        <div id="example-path" class="click-animate">
                            <div class="line a"></div>
                            <div class="line b"></div>
                            <div class="line c"></div>

                            <div class="square"></div>
                            <div class="square alt"></div>

                            <div class="circle default"></div>
                            <div class="circle main"></div>
                            <div class="circle alt"></div>

                        </div>
                    </section>

                    <section>
                        <h2>Just for games?</h2>
                        <p>No! Pathfinding is important for building complex HTML5 apps</p>

                        <div class="img-caption">
                            <img width="300" height="300" src="assets/google-maps.jpg" />
                            <span style="max-width: 300px;">Fastest Route</span>
                        </div>

                        <div class="img-caption">
                            <img width="300" height="300" src="assets/get-resources.jpg" />
                            <span style="max-width: 300px;">Acquire Resources</span>
                        </div>

                        <div class="img-caption">
                            <img width="300" height="300" src="assets/robotics-engineering.jpg" />
                            <span style="max-width: 300px;">Robotics Engineering</span>
                        </div>
                    </section>
                </section>

				<section>
                    <section>
                        <h2>Popular Pathfinding Algorithms</h2>
                        <ul>
                            <li>Brute Force</li>
                            <li>Monte Carlo</li>
                            <li>Dijkstra</li>
                            <li><a href="http://en.wikipedia.org/wiki/Pathfinding">Many others</a></li>
                        </ul>
                    </section>

                    <section>
                        <h2>A* (Golden Solution)</h2>
                        <ul>
                            <li>Customizable</li>
                            <li>Fast</li>
                            <li>Reusable</li>
                            <li>Minimal code</li>
                        </ul>
                    </section>
				</section>

                <section>
                    <section>
                        <h2>A* In Action</h2>

                        <p>Get our hero to the treasure with the shortest path</p>
                        <small>(click to move)</small>

                        <div class="pathfinder">
                            <div class="matrix">
                                <div class="row">
                                    <div data-x="0" data-y="0" class="voxel"></div>
                                    <div data-x="1" data-y="0" class="voxel"></div>
                                    <div data-x="2" data-y="0" class="voxel"></div>
                                    <div data-x="3" data-y="0" class="voxel"></div>
                                    <div data-x="4" data-y="0" class="voxel"></div>
                                    <div data-x="5" data-y="0" class="voxel" data-pos="end"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="1" class="voxel"></div>
                                    <div data-x="1" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="1" class="voxel"></div>
                                    <div data-x="4" data-y="1" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="1" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="2" class="voxel"></div>
                                    <div data-x="1" data-y="2" class="voxel"></div>
                                    <div data-x="2" data-y="2" class="voxel"></div>
                                    <div data-x="3" data-y="2" class="voxel alt" data-cost="0"></div>
                                    <div data-x="4" data-y="2" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="2" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="3" class="voxel alt" data-cost="0"></div>
                                    <div data-x="1" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="3" class="voxel"></div>
                                    <div data-x="3" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="4" data-y="3" class="voxel"></div>
                                    <div data-x="5" data-y="3" class="voxel" data-cost="0"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="4" class="voxel"></div>
                                    <div data-x="1" data-y="4" class="voxel" data-pos="start"><span class="player"></span></div>
                                    <div data-x="2" data-y="4" class="voxel"></div>
                                    <div data-x="3" data-y="4" class="voxel"></div>
                                    <div data-x="4" data-y="4" class="voxel"></div>
                                    <div data-x="5" data-y="4" class="voxel" data-cost="2"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="5" class="voxel"></div>
                                    <div data-x="1" data-y="5" class="voxel"></div>
                                    <div data-x="2" data-y="5" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="5" class="voxel"></div>
                                    <div data-x="4" data-y="5" class="voxel"></div>
                                    <div data-x="5" data-y="5" class="voxel"></div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h2>Break Map Into Voxels</h2>
                        <ul>
                            <li>Use largest blocks possible</li>
                            <li>Small voxels hurt performance</li>
                        </ul>

                        <div class="pathfinder grid">
                            <div class="matrix">
                                <div class="row">
                                    <div data-x="0" data-y="0" class="voxel"></div>
                                    <div data-x="1" data-y="0" class="voxel"></div>
                                    <div data-x="2" data-y="0" class="voxel"></div>
                                    <div data-x="3" data-y="0" class="voxel"></div>
                                    <div data-x="4" data-y="0" class="voxel"></div>
                                    <div data-x="5" data-y="0" class="voxel" data-pos="end"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="1" class="voxel"></div>
                                    <div data-x="1" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="1" class="voxel"></div>
                                    <div data-x="4" data-y="1" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="1" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="2" class="voxel"></div>
                                    <div data-x="1" data-y="2" class="voxel"></div>
                                    <div data-x="2" data-y="2" class="voxel"></div>
                                    <div data-x="3" data-y="2" class="voxel alt" data-cost="0"></div>
                                    <div data-x="4" data-y="2" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="2" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="3" class="voxel alt" data-cost="0"></div>
                                    <div data-x="1" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="3" class="voxel"></div>
                                    <div data-x="3" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="4" data-y="3" class="voxel"></div>
                                    <div data-x="5" data-y="3" class="voxel" data-cost="0"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="4" class="voxel"></div>
                                    <div data-x="1" data-y="4" class="voxel" data-pos="start"><span class="player"></span></div>
                                    <div data-x="2" data-y="4" class="voxel"></div>
                                    <div data-x="3" data-y="4" class="voxel"></div>
                                    <div data-x="4" data-y="4" class="voxel"></div>
                                    <div data-x="5" data-y="4" class="voxel" data-cost="2"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="5" class="voxel"></div>
                                    <div data-x="1" data-y="5" class="voxel"></div>
                                    <div data-x="2" data-y="5" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="5" class="voxel"></div>
                                    <div data-x="4" data-y="5" class="voxel"></div>
                                    <div data-x="5" data-y="5" class="voxel"></div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h2>Identify Tile Types</h2>
                        <ul>
                            <li>Identify blockers</li>
                            <li>Get walkable tiles with cost</li>
                        </ul>

                        <div class="pathfinder grid type">
                            <div class="matrix">
                                <div class="row">
                                    <div data-x="0" data-y="0" class="voxel"></div>
                                    <div data-x="1" data-y="0" class="voxel"></div>
                                    <div data-x="2" data-y="0" class="voxel"></div>
                                    <div data-x="3" data-y="0" class="voxel"></div>
                                    <div data-x="4" data-y="0" class="voxel"></div>
                                    <div data-x="5" data-y="0" class="voxel" data-pos="end"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="1" class="voxel"></div>
                                    <div data-x="1" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="1" class="voxel"></div>
                                    <div data-x="4" data-y="1" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="1" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="2" class="voxel"></div>
                                    <div data-x="1" data-y="2" class="voxel"></div>
                                    <div data-x="2" data-y="2" class="voxel"></div>
                                    <div data-x="3" data-y="2" class="voxel alt" data-cost="0"></div>
                                    <div data-x="4" data-y="2" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="2" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="3" class="voxel alt" data-cost="0"></div>
                                    <div data-x="1" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="3" class="voxel"></div>
                                    <div data-x="3" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="4" data-y="3" class="voxel"></div>
                                    <div data-x="5" data-y="3" class="voxel" data-cost="0"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="4" class="voxel"></div>
                                    <div data-x="1" data-y="4" class="voxel" data-pos="start"><span class="player"></span></div>
                                    <div data-x="2" data-y="4" class="voxel"></div>
                                    <div data-x="3" data-y="4" class="voxel"></div>
                                    <div data-x="4" data-y="4" class="voxel"></div>
                                    <div data-x="5" data-y="4" class="voxel" data-cost="2"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="5" class="voxel"></div>
                                    <div data-x="1" data-y="5" class="voxel"></div>
                                    <div data-x="2" data-y="5" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="5" class="voxel"></div>
                                    <div data-x="4" data-y="5" class="voxel"></div>
                                    <div data-x="5" data-y="5" class="voxel"></div>
                                </div>
                            </div>
                            <div class="map-key">
                                <span class="blocked">0: Blocked</span>
                                <span class="open">1: Open</span>
                                <span class="water">2: Water</span>
                                <span class="start">Start</span>
                                <span class="end">End</span>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h2>Count Steps</h2>
                        <ul>
                            <li>A* steps examines 1 tile at a time with neighbors (step)</li>
                            <li>Lower step count / distance prioritized</li>
                        </ul>

                        <div class="pathfinder history grid type show-step hide-group">
                            <div class="matrix">
                                <div class="row">
                                    <div data-x="0" data-y="0" class="voxel"></div>
                                    <div data-x="1" data-y="0" class="voxel"></div>
                                    <div data-x="2" data-y="0" class="voxel"></div>
                                    <div data-x="3" data-y="0" class="voxel"></div>
                                    <div data-x="4" data-y="0" class="voxel"></div>
                                    <div data-x="5" data-y="0" class="voxel" data-pos="end"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="1" class="voxel"></div>
                                    <div data-x="1" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="1" class="voxel"></div>
                                    <div data-x="4" data-y="1" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="1" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="2" class="voxel"></div>
                                    <div data-x="1" data-y="2" class="voxel"></div>
                                    <div data-x="2" data-y="2" class="voxel"></div>
                                    <div data-x="3" data-y="2" class="voxel alt" data-cost="0"></div>
                                    <div data-x="4" data-y="2" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="2" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="3" class="voxel alt" data-cost="0"></div>
                                    <div data-x="1" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="3" class="voxel"></div>
                                    <div data-x="3" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="4" data-y="3" class="voxel"></div>
                                    <div data-x="5" data-y="3" class="voxel" data-cost="0"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="4" class="voxel"></div>
                                    <div data-x="1" data-y="4" class="voxel" data-pos="start"><span class="player"></span></div>
                                    <div data-x="2" data-y="4" class="voxel"></div>
                                    <div data-x="3" data-y="4" class="voxel"></div>
                                    <div data-x="4" data-y="4" class="voxel"></div>
                                    <div data-x="5" data-y="4" class="voxel" data-cost="2"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="5" class="voxel"></div>
                                    <div data-x="1" data-y="5" class="voxel"></div>
                                    <div data-x="2" data-y="5" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="5" class="voxel"></div>
                                    <div data-x="4" data-y="5" class="voxel"></div>
                                    <div data-x="5" data-y="5" class="voxel"></div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h2>Distance Heuristics</h2>
                        <ul>
                            <li>Estimates distance to goal</li>
                            <li>Manhattan or Euclidean?</li>
                            <li>Demo uses Manhattan for speed</li>
                        </ul>

                        <pre><code data-trim contenteditable>
function euclidean (xC, yC, xT, yT) {
    var dx = xT - xC, dy = yT - yC;
    return Math.sqrt((dx * dx) + (dy * dy));
}

function manhattan (xC, yC, xT, yT) {
    var dx = Math.abs(xT - xC), dy = Math.abs(yT - yC);
    return dx + dy;
}
                        </code></pre>
                    </section>

                    <section>
                        <h2>Heuristic in Action</h2>

                        <ul>
                            <li>Displayed value is estimated distance to target</li>
                            <li>Accurate in most cases</li>
                        </ul>

                        <div class="pathfinder history grid type show-heuristic hide-group">
                            <div class="matrix">
                                <div class="row">
                                    <div data-x="0" data-y="0" class="voxel"></div>
                                    <div data-x="1" data-y="0" class="voxel"></div>
                                    <div data-x="2" data-y="0" class="voxel"></div>
                                    <div data-x="3" data-y="0" class="voxel"></div>
                                    <div data-x="4" data-y="0" class="voxel"></div>
                                    <div data-x="5" data-y="0" class="voxel" data-pos="end"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="1" class="voxel"></div>
                                    <div data-x="1" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="1" class="voxel"></div>
                                    <div data-x="4" data-y="1" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="1" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="2" class="voxel"></div>
                                    <div data-x="1" data-y="2" class="voxel"></div>
                                    <div data-x="2" data-y="2" class="voxel"></div>
                                    <div data-x="3" data-y="2" class="voxel alt" data-cost="0"></div>
                                    <div data-x="4" data-y="2" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="2" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="3" class="voxel alt" data-cost="0"></div>
                                    <div data-x="1" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="3" class="voxel"></div>
                                    <div data-x="3" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="4" data-y="3" class="voxel"></div>
                                    <div data-x="5" data-y="3" class="voxel" data-cost="0"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="4" class="voxel"></div>
                                    <div data-x="1" data-y="4" class="voxel" data-pos="start"><span class="player"></span></div>
                                    <div data-x="2" data-y="4" class="voxel"></div>
                                    <div data-x="3" data-y="4" class="voxel"></div>
                                    <div data-x="4" data-y="4" class="voxel"></div>
                                    <div data-x="5" data-y="4" class="voxel" data-cost="2"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="5" class="voxel"></div>
                                    <div data-x="1" data-y="5" class="voxel"></div>
                                    <div data-x="2" data-y="5" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="5" class="voxel"></div>
                                    <div data-x="4" data-y="5" class="voxel"></div>
                                    <div data-x="5" data-y="5" class="voxel"></div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section>
                        <h2>Open and Closed Sets</h2>
                        <ul>
                            <li><span style="color: #0c0;">Open</span>: Yet to be evaluated</li>
                            <li><span style="color: #c00">Closed</span>: Evaluated tile</li>
                            <li>A* Always chooses best open</li>
                            <li>Best open found through heuristic + step cost</li>
                        </ul>
                    </section>

                    <section>
                        <h2>Putting Everything Together</h2>

                        <ul>
                            <li>Total = Steps + Heuristic</li>
                            <li>Click for interactive walkthrough</li>
                        </ul>

                        <div class="pathfinder history grid type show-stats">
                            <div class="matrix">
                                <div class="row">
                                    <div data-x="0" data-y="0" class="voxel"></div>
                                    <div data-x="1" data-y="0" class="voxel"></div>
                                    <div data-x="2" data-y="0" class="voxel"></div>
                                    <div data-x="3" data-y="0" class="voxel"></div>
                                    <div data-x="4" data-y="0" class="voxel"></div>
                                    <div data-x="5" data-y="0" class="voxel" data-pos="end"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="1" class="voxel"></div>
                                    <div data-x="1" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="1" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="1" class="voxel"></div>
                                    <div data-x="4" data-y="1" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="1" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="2" class="voxel"></div>
                                    <div data-x="1" data-y="2" class="voxel"></div>
                                    <div data-x="2" data-y="2" class="voxel"></div>
                                    <div data-x="3" data-y="2" class="voxel alt" data-cost="0"></div>
                                    <div data-x="4" data-y="2" class="voxel" data-cost="2"></div>
                                    <div data-x="5" data-y="2" class="voxel"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="3" class="voxel alt" data-cost="0"></div>
                                    <div data-x="1" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="2" data-y="3" class="voxel"></div>
                                    <div data-x="3" data-y="3" class="voxel" data-cost="0"></div>
                                    <div data-x="4" data-y="3" class="voxel"></div>
                                    <div data-x="5" data-y="3" class="voxel" data-cost="0"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="4" class="voxel"></div>
                                    <div data-x="1" data-y="4" class="voxel" data-pos="start"><span class="player"></span></div>
                                    <div data-x="2" data-y="4" class="voxel"></div>
                                    <div data-x="3" data-y="4" class="voxel"></div>
                                    <div data-x="4" data-y="4" class="voxel"></div>
                                    <div data-x="5" data-y="4" class="voxel" data-cost="2"></div>
                                </div>

                                <div class="row">
                                    <div data-x="0" data-y="5" class="voxel"></div>
                                    <div data-x="1" data-y="5" class="voxel"></div>
                                    <div data-x="2" data-y="5" class="voxel" data-cost="0"></div>
                                    <div data-x="3" data-y="5" class="voxel"></div>
                                    <div data-x="4" data-y="5" class="voxel"></div>
                                    <div data-x="5" data-y="5" class="voxel"></div>
                                </div>
                            </div>
                        </div>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Map API</h2>
                        <ul style="margin-bottom: 40px;">
                            <li>Abstracts map data from pathfinder</li>
                            <li>Most A* customization happens here</li>
                            <li>Using John Resig's <a href="http://ejohn.org/blog/simple-javascript-inheritance/">Simple JavaScript Inheritance</a><br/> for instances</li>
                        </ul>

                        <h3>Method Overview</h3>
                        <ol>
                            <li>setMap</li>
                            <li>outOfBounds</li>
                            <li>getNeighbors</li>
                        </ol>
                    </section>

                    <section>
                        <h2>setMap</h2>
                        <ul style="margin-bottom: 20px;">
                            <li>Break map down to voxels</li>
                            <li>Use a multi-dimensional array (usually 2D)</li>
                            <li>HTML/CSS users loop through data via jQuery</li>
                            <li>Complex games require looking at multiple maps (collision, entities, other)</li>
                        </ul>

                        <img src="assets/map/map-to-data.png" />
                    </section>

                    <section>
                        <h2>OutOfBounds</h2>
                        <ul>
                            <li>Check for overflowing indices on map data</li>
                            <li>Prevents errors from crashing the app</li>
                        </ul>

<pre><code data-trim>
window.Map = window.Class.extend({
    ...
    outOfBounds: function (x, y) {
        return x < 0 || x >= this.data[0].length ||
        y < 0 || y >= this.data.length;
    },
    ...
});
</code></pre>
                    </section>

                    <section>
                        <h2>GetNeighbors</h2>
                        <ul>
                            <li>Find all open adjacent tiles</li>
                            <li>Tweak for diagonal by returning corners here</li>
                            <li>Add 3D z-index by returning tiles above and below</li>
                        </ul>

<pre><code data-trim>
window.Map = window.Class.extend({
    ...
    getNeighbors: function (x, y) {
        var neighbors = [];

        // Check top, right, bottom, left (clockwise)
        if (!this.blocked(x, y - 1)) neighbors.push(new window.Tile(x, y - 1));
        if (!this.blocked(x + 1, y)) neighbors.push(new window.Tile(x + 1, y));
        if (!this.blocked(x, y + 1)) neighbors.push(new window.Tile(x, y + 1));
        if (!this.blocked(x - 1, y)) neighbors.push(new window.Tile(x - 1, y));

        return neighbors;
    },
    ...
});
</code></pre>
                    </section>

                    <section>
                        <h2>Completed Map</h2>

                        <pre><code data-trim>
window.Map = window.Class.extend({
    data: null, // Current map

    init: function (data) {
        this.data = data;
    },

    outOfBounds: function (x, y) {
        return x < 0 || x >= this.data[0].length ||
            y < 0 || y >= this.data.length;
    },

    getWidthInTiles: function () {
        return this.data[0].length;
    },

    getHeightInTiles: function () {
        return this.data.length;
    },

    blocked: function (x, y) {
        if (this.outOfBounds(x, y)) {
            return true;
        }

        if (this.data[y][x] === 0) {
            return true;
        }

        return false;
    },

    getNeighbors: function (x, y) {
        var neighbors = [];

        if (!this.blocked(x, y - 1)) neighbors.push(new window.Tile(x, y - 1));
        if (!this.blocked(x + 1, y)) neighbors.push(new window.Tile(x + 1, y));
        if (!this.blocked(x, y + 1)) neighbors.push(new window.Tile(x, y + 1));
        if (!this.blocked(x - 1, y)) neighbors.push(new window.Tile(x - 1, y));

        return neighbors;
    },


    getCost: function (xC, yC, xT, yT) {
        return this.data[yT][xT];
    }
});
                        </code></pre>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Pathfinder API</h2>
                        <ul style="margin-bottom: 40px;">
                            <li>Navigates through map data</li>
                            <li>Each creature will need its own pathfinder</li>
                            <li>Returns a completed path that can be navigated</li>
                        </ul>

                        <h3>Topic Overview</h3>
                        <ol>
                            <li>Close commands</li>
                            <li>Open commands</li>
                            <li>findPath Walkthrough</li>
                            <li>Assembling a path</li>
                        </ol>
                    </section>

                    <section>
                        <h2>Close Commands</h2>

                        <p>Simple interface to manage closed tiles</p>

                        <pre><code class="javascript" data-trim>
window.PathFinder = window.Class.extend({
    ...
    // New closed tile
    addClosed: function (step) {
        this.addHistory(step, 'closed');
        this.closed.push(step);
        return this;
    },

    // Check for existing closed tile
    inClosed: function (step) {
        for (var i = 0; i < this.closed.length; i++) {
            if (this.closed[i].x === step.x && this.closed[i].y === step.y)
                return this.closed[i];
        }

        return false;
    },
    ...
});
                        </code></pre>
                    </section>

                    <section>
                        <h2>Open Commands</h2>

                        <p>Used to store and analyze group data</p>

                        <pre><code data-trim>
window.PathFinder = window.Class.extend({
    ...
    // Adds a new tile
    addOpen: function (step) {
        this.open.push(step);
        return this;
    },

    // Removes an existing tile
    removeOpen: function (step) {
        for (var i = 0; i < this.open.length; i++) {
            if (this.open[i] === step) this.open.splice(i, 1);
        }
        return this;
    },

    // Check if the step is already in the open set
    inOpen: function (step) {
        for (var i = 0; i < this.open.length; i++) {
            if (this.open[i].x === step.x && this.open[i].y === step.y)
                return this.open[i];
        }

        return false;
    },

    // Get the best possible tile from the open set
    getBestOpen: function () {
        var bestI = 0;
        for (var i = 0; i < this.open.length; i++) {
            if (this.open[i].f < this.open[bestI].f) bestI = i;
        }

        return this.open[bestI];
    },
    ...
});
                        </code></pre>
                    </section>

                    <section>
                        <h2>findPath Walkthrough</h2>

                        <p>This walks through the map API data finds a walkable path</p>

                        <pre><code data-trim>
window.PathFinder = window.Class.extend({
    ...
    findPath: function (xC, yC, xT, yT) {
        var current, // Current best open tile
            neighbors, // Dump of all nearby neighbor tiles
            neighborRecord, // Any pre-existing records of a neighbor
            stepCost, // Dump of a total step score for a neighbor
            i;

        // You must add the starting step
        this.reset()
            .addOpen(new window.Step(xC, yC, xT, yT, this.step, false));

        while (this.open.length !== 0) {
            this.step++;
            current = this.getBestOpen();

            // Check if goal has been discovered to build a path
            if (current.x === xT && current.y === yT) {
                return this.buildPath(current, []);
            }

            // Move current into closed set
            this.removeOpen(current)
                .addClosed(current);

            // Get neighbors from the map and check them
            neighbors = this.map.getNeighbors(current.x, current.y);
            for (i = 0; i < neighbors.length; i++) {
                this.step++;

                // Get current step and distance from current to neighbor
                stepCost = current.g + this.map.getCost(current.x, current.y, neighbors[i].x, neighbors[i].y);

                // Check for the neighbor in the closed set
                // then see if its cost is >= the stepCost, if so skip current neighbor
                neighborRecord = this.inClosed(neighbors[i]);
                if (neighborRecord && stepCost >= neighborRecord.g)
                    continue;

                // Verify neighbor doesn't exist or new score for it is better
                neighborRecord = this.inOpen(neighbors[i]);
                if (!neighborRecord || stepCost < neighborRecord.g) {
                    if (!neighborRecord) {
                        this.addOpen(new window.Step(neighbors[i].x, neighbors[i].y, xT, yT, stepCost, current));
                    } else {
                        neighborRecord.parent = current;
                        neighborRecord.g = stepCost;
                        neighborRecord.f = stepCost + neighborRecord.h;
                    }
                }
            }
        }

        return false;
    },
    ...
});
                        </code></pre>
                    </section>

                    <section>
                        <h2>Assembling a path</h2>

                        <p>Assemble walkable path from closed group</p>

                        <pre><code class="javascript" data-trim>
window.PathFinder = window.Class.extend({
    ...
    // Recursive path building method
    buildPath: function (tile, stack) {
        stack.push(tile);

        // Look at every parent and step back until no parents are left
        if (tile.parent) {
            return this.buildPath(tile.parent, stack);
        } else {
            return stack;
        }
    },
    ...
});
                        </code></pre>
                    </section>

                    <section>
                        <h2>Completed Pathfinder</h2>

                        <pre><code data-trim>
window.PathFinder = window.Class.extend({
    map: null, // Map class reference
    closed: null, // Taken steps
    open: null, // Available steps that can be taken
    history: null,
    step: 0, // Step count
    maxSearchDistance: 100, // Maximum number of steps that can be taken before shutting down a closed path

    init: function (map) {
        this.closed = [];
        this.open = [];
        this.history = [];
        this.map = map;
    },

    addOpen: function (step) {
        this.addHistory(step, 'open');
        this.open.push(step);
        return this;
    },

    // Remove a step that already exists by object memory address (not actual x and y values)
    removeOpen: function (step) {
        for (var i = 0; i < this.open.length; i++) {
            if (this.open[i] === step) this.open.splice(i, 1);
        }
        return this;
    },

    // Check if the step is already in the open set
    inOpen: function (step) {
        for (var i = 0; i < this.open.length; i++) {
            if (this.open[i].x === step.x && this.open[i].y === step.y)
                return this.open[i];
        }

        return false;
    },

    // Get the lowest costing tile in the open set
    getBestOpen: function () {
        var bestI = 0;
        for (var i = 0; i < this.open.length; i++) {
            if (this.open[i].f < this.open[bestI].f) bestI = i;
        }

        return this.open[bestI];
    },

    addClosed: function (step) {
        this.addHistory(step, 'closed');
        this.closed.push(step);
        return this;
    },

    // Check if the step is already in the closed set
    inClosed: function (step) {
        for (var i = 0; i < this.closed.length; i++) {
            if (this.closed[i].x === step.x && this.closed[i].y === step.y)
                return this.closed[i];
        }

        return false;
    },

    addHistory: function (step, group) {
        this.history.push({
            step: step,
            group: group
        });
    },

    findPath: function (xC, yC, xT, yT) {
        var current, // Current best open tile
            neighbors, // Dump of all nearby neighbor tiles
            neighborRecord, // Any pre-existing records of a neighbor
            stepCost, // Dump of a total step score for a neighbor
            i;

        // You must add the starting step
        this.reset()
            .addOpen(new window.Step(xC, yC, xT, yT, this.step, false));

        while (this.open.length !== 0) {
            this.step++;
            current = this.getBestOpen();

            // Check if goal has been discovered to build a path
            if (current.x === xT && current.y === yT) {
                return this.buildPath(current, []);
            }

            // Move current into closed set
            this.removeOpen(current)
                .addClosed(current);

            // Get neighbors from the map and check them
            neighbors = this.map.getNeighbors(current.x, current.y);
            for (i = 0; i < neighbors.length; i++) {
                this.step++;

                // Get current step and distance from current to neighbor
                stepCost = current.g + this.map.getCost(current.x, current.y, neighbors[i].x, neighbors[i].y);

                // Check for the neighbor in the closed set
                // then see if its cost is >= the stepCost, if so skip current neighbor
                neighborRecord = this.inClosed(neighbors[i]);
                if (neighborRecord && stepCost >= neighborRecord.g)
                    continue;

                // Verify neighbor doesn't exist or new score for it is better
                neighborRecord = this.inOpen(neighbors[i]);
                if (!neighborRecord || stepCost < neighborRecord.g) {
                    if (!neighborRecord) {
                        this.addOpen(new window.Step(neighbors[i].x, neighbors[i].y, xT, yT, stepCost, current));
                    } else {
                        neighborRecord.parent = current;
                        neighborRecord.g = stepCost;
                        neighborRecord.f = stepCost + neighborRecord.h;
                    }
                }
            }
        }

        return false;
    },

    // Recursive path buliding method
    buildPath: function (tile, stack) {
        stack.push(tile);

        if (tile.parent) {
            return this.buildPath(tile.parent, stack);
        } else {
            return stack;
        }
    },

    reset: function () {
        this.closed = [];
        this.open = [];
        return this;
    }
});
                        </code></pre>
                    </section>
                </section>

                <section>
                    <section>
                        <h2>Pathfinding with gravity</h2>

                        <p>For use with platformers and other games requiring gravity</p>

                        <ul>
                            <li>JavaScript library: <a href="http://ashblue.github.io/pathfinding-platformer/">Pathfinding Platformer</a></li>
                            <li>Currently used for <a href="http://playadnc.com">A Dragon Named Coal's</a> companion system</li>
                            <li>Trick to A* with gravity is figuring out where you can't move and ledge dropoffs</li>
                        </ul>

                        <img src="assets/gravity.png" width="400" />
                        <img src="assets/adnc-gravity.png" width="450" />
                    </section>

                    <section>
                        <h2>Clearance values</h2>

                        <p>For when moving characters takes up more than one tile</p>

                        <ul>
                            <li>Just a few lines for A*</li>
                            <li>Requires an extra map of data</li>
                        </ul>

                        <p style="text-align: center"><a href="https://aigamedev.com/open/tutorials/clearance-based-pathfinding/">Tutorial</a></p>

                        <img src="assets/clearance.png" />

                    </section>

                    <section>
                        <h2>Boxed JS pathfinding solutions</h2>

                        <p>Not many solutions out there yet. Most are weekend hack projects (not maintained). These are two of the best.</p>

                        <ul>
                            <li><a href="http://www.easystarjs.com/">EasyStar</a></li>
                            <li><a href="http://qiao.github.io/PathFinding.js/visual/">PathFinding.js</a></li>
                        </ul>
                    </section>

                    <section>
                        <h2>More learning resources</h2>

                        <ul>
                            <li>
                                <a href="http://www.raywenderlich.com/4946/introduction-to-a-pathfinding">
                                    Introduction to A*
                                </a>
                            </li>
                            <li>
                                <a href="http://en.wikipedia.org/wiki/A*_search_algorithm">
                                    A* for any language (pseudo code)
                                </a>
                            </li>
                        </ul>
                    </section>
                </section>

                <section>
                    <h2>Any Questions?</h2>

                    <ul>
                        <li>Stay in contact: <a href="https://twitter.com/AshBlueWD">@ashbluewd</a></li>
                        <li>Get the slides: <a href="http://ashblue.github.io/pathfinding-presentation">http://tim.pe/30q</a></li>
                    </ul>
                </section>
			</div>

		</div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Parallax scrolling
				// parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
				// parallaxBackgroundSize: '2100px 900px',

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
